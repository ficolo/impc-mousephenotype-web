{"ast":null,"code":"import _pt from \"prop-types\";\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nimport React, { useContext, useMemo, useEffect, useCallback } from 'react';\nimport { scaleBand } from '@visx/scale';\nimport isChildWithProps from '../../../typeguards/isChildWithProps';\nimport DataContext from '../../../context/DataContext';\nimport getScaleBandwidth from '../../../utils/getScaleBandwidth';\nimport getScaleBaseline from '../../../utils/getScaleBaseline';\nimport isValidNumber from '../../../typeguards/isValidNumber';\nimport { BARGROUP_EVENT_SOURCE, XYCHART_EVENT_SOURCE } from '../../../constants';\nimport useSeriesEvents from '../../../hooks/useSeriesEvents';\nimport findNearestGroupDatum from '../../../utils/findNearestGroupDatum';\nexport default function BaseBarGroup(_ref) {\n  var children = _ref.children,\n      _ref$padding = _ref.padding,\n      padding = _ref$padding === void 0 ? 0.1 : _ref$padding,\n      sortBars = _ref.sortBars,\n      BarsComponent = _ref.BarsComponent,\n      onBlur = _ref.onBlur,\n      onFocus = _ref.onFocus,\n      onPointerMove = _ref.onPointerMove,\n      onPointerOut = _ref.onPointerOut,\n      onPointerUp = _ref.onPointerUp,\n      _ref$enableEvents = _ref.enableEvents,\n      enableEvents = _ref$enableEvents === void 0 ? true : _ref$enableEvents;\n\n  var _ref2 = useContext(DataContext),\n      colorScale = _ref2.colorScale,\n      dataRegistry = _ref2.dataRegistry,\n      horizontal = _ref2.horizontal,\n      registerData = _ref2.registerData,\n      unregisterData = _ref2.unregisterData,\n      xScale = _ref2.xScale,\n      yScale = _ref2.yScale;\n\n  var barSeriesChildren = useMemo(function () {\n    return React.Children.toArray(children).filter(function (child) {\n      return isChildWithProps(child);\n    });\n  }, [children]); // extract data keys from child series\n\n  var dataKeys = useMemo(function () {\n    return barSeriesChildren.map(function (child) {\n      var _child$props$dataKey;\n\n      return (_child$props$dataKey = child.props.dataKey) != null ? _child$props$dataKey : '';\n    }).filter(function (key) {\n      return key;\n    });\n  }, [barSeriesChildren]); // register all child data\n\n  useEffect(function () {\n    var dataToRegister = barSeriesChildren.map(function (child) {\n      var _child$props = child.props,\n          key = _child$props.dataKey,\n          data = _child$props.data,\n          xAccessor = _child$props.xAccessor,\n          yAccessor = _child$props.yAccessor;\n      return {\n        key: key,\n        data: data,\n        xAccessor: xAccessor,\n        yAccessor: yAccessor\n      };\n    });\n    registerData(dataToRegister);\n    return function () {\n      return unregisterData(dataKeys);\n    };\n  }, [registerData, unregisterData, barSeriesChildren, dataKeys]); // create group scale\n\n  var groupScale = useMemo(function () {\n    return scaleBand({\n      domain: sortBars ? [].concat(dataKeys).sort(sortBars) : dataKeys,\n      range: [0, getScaleBandwidth(horizontal ? yScale : xScale)],\n      padding: padding\n    });\n  }, [sortBars, dataKeys, xScale, yScale, horizontal, padding]);\n  var findNearestDatum = useCallback(function (params) {\n    return findNearestGroupDatum(params, groupScale, horizontal);\n  }, [groupScale, horizontal]);\n  var ownEventSourceKey = BARGROUP_EVENT_SOURCE + \"-\" + dataKeys.join('-') + \"}\";\n  var eventEmitters = useSeriesEvents({\n    dataKey: dataKeys,\n    enableEvents: enableEvents,\n    findNearestDatum: findNearestDatum,\n    onBlur: onBlur,\n    onFocus: onFocus,\n    onPointerMove: onPointerMove,\n    onPointerOut: onPointerOut,\n    onPointerUp: onPointerUp,\n    source: ownEventSourceKey,\n    allowedSources: [XYCHART_EVENT_SOURCE, ownEventSourceKey]\n  });\n  var xZeroPosition = useMemo(function () {\n    return xScale ? getScaleBaseline(xScale) : 0;\n  }, [xScale]);\n  var yZeroPosition = useMemo(function () {\n    return yScale ? getScaleBaseline(yScale) : 0;\n  }, [yScale]);\n  var registryEntries = dataKeys.map(function (key) {\n    return dataRegistry.get(key);\n  }); // if scales and data are not available in the registry, bail\n\n  if (registryEntries.some(function (entry) {\n    return entry == null;\n  }) || !xScale || !yScale || !colorScale) {\n    return null;\n  }\n\n  var barThickness = getScaleBandwidth(groupScale);\n  var bars = registryEntries.flatMap(function (_ref3) {\n    var _groupScale, _barSeriesChildren$fi, _barSeriesChildren$fi2;\n\n    var xAccessor = _ref3.xAccessor,\n        yAccessor = _ref3.yAccessor,\n        data = _ref3.data,\n        key = _ref3.key;\n\n    var getLength = function getLength(d) {\n      var _xScale, _yScale;\n\n      return horizontal ? ((_xScale = xScale(xAccessor(d))) != null ? _xScale : NaN) - xZeroPosition : ((_yScale = yScale(yAccessor(d))) != null ? _yScale : NaN) - yZeroPosition;\n    };\n\n    var getGroupPosition = horizontal ? function (d) {\n      var _yScale2;\n\n      return (_yScale2 = yScale(yAccessor(d))) != null ? _yScale2 : NaN;\n    } : function (d) {\n      var _xScale2;\n\n      return (_xScale2 = xScale(xAccessor(d))) != null ? _xScale2 : NaN;\n    };\n    var withinGroupPosition = (_groupScale = groupScale(key)) != null ? _groupScale : 0;\n    var getX = horizontal ? function (d) {\n      return xZeroPosition + Math.min(0, getLength(d));\n    } : function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    };\n    var getY = horizontal ? function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    } : function (d) {\n      return yZeroPosition + Math.min(0, getLength(d));\n    };\n    var getWidth = horizontal ? function (d) {\n      return Math.abs(getLength(d));\n    } : function () {\n      return barThickness;\n    };\n    var getHeight = horizontal ? function () {\n      return barThickness;\n    } : function (d) {\n      return Math.abs(getLength(d));\n    };\n    var colorAccessor = (_barSeriesChildren$fi = barSeriesChildren.find(function (child) {\n      return child.props.dataKey === key;\n    })) == null ? void 0 : (_barSeriesChildren$fi2 = _barSeriesChildren$fi.props) == null ? void 0 : _barSeriesChildren$fi2.colorAccessor;\n    return data.map(function (bar, index) {\n      var _colorAccessor;\n\n      var barX = getX(bar);\n      if (!isValidNumber(barX)) return null;\n      var barY = getY(bar);\n      if (!isValidNumber(barY)) return null;\n      var barWidth = getWidth(bar);\n      if (!isValidNumber(barWidth)) return null;\n      var barHeight = getHeight(bar);\n      if (!isValidNumber(barHeight)) return null;\n      return {\n        key: key + \"-\" + index,\n        x: barX,\n        y: barY,\n        width: barWidth,\n        height: barHeight,\n        fill: (_colorAccessor = colorAccessor == null ? void 0 : colorAccessor(bar, index)) != null ? _colorAccessor : colorScale(key)\n      };\n    }).filter(function (bar) {\n      return bar;\n    });\n  });\n  return /*#__PURE__*/React.createElement(\"g\", {\n    className: \"visx-bar-group\"\n  }, /*#__PURE__*/React.createElement(BarsComponent, _extends({\n    bars: bars,\n    horizontal: horizontal,\n    xScale: xScale,\n    yScale: yScale\n  }, eventEmitters)));\n}\nBaseBarGroup.propTypes = {\n  children: _pt.oneOfType([_pt.element, _pt.arrayOf(_pt.element)]).isRequired,\n  padding: _pt.number,\n  sortBars: _pt.func\n};","map":{"version":3,"sources":["/Users/federico/git/test/impc-mousephenotype-web/node_modules/@visx/xychart/esm/components/series/private/BaseBarGroup.js"],"names":["_pt","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","useContext","useMemo","useEffect","useCallback","scaleBand","isChildWithProps","DataContext","getScaleBandwidth","getScaleBaseline","isValidNumber","BARGROUP_EVENT_SOURCE","XYCHART_EVENT_SOURCE","useSeriesEvents","findNearestGroupDatum","BaseBarGroup","_ref","children","_ref$padding","padding","sortBars","BarsComponent","onBlur","onFocus","onPointerMove","onPointerOut","onPointerUp","_ref$enableEvents","enableEvents","_ref2","colorScale","dataRegistry","horizontal","registerData","unregisterData","xScale","yScale","barSeriesChildren","Children","toArray","filter","child","dataKeys","map","_child$props$dataKey","props","dataKey","dataToRegister","_child$props","data","xAccessor","yAccessor","groupScale","domain","concat","sort","range","findNearestDatum","params","ownEventSourceKey","join","eventEmitters","allowedSources","xZeroPosition","yZeroPosition","registryEntries","get","some","entry","barThickness","bars","flatMap","_ref3","_groupScale","_barSeriesChildren$fi","_barSeriesChildren$fi2","getLength","d","_xScale","_yScale","NaN","getGroupPosition","_yScale2","_xScale2","withinGroupPosition","getX","Math","min","getY","getWidth","abs","getHeight","colorAccessor","find","bar","index","_colorAccessor","barX","barY","barWidth","barHeight","x","y","width","height","fill","createElement","className","propTypes","oneOfType","element","arrayOf","isRequired","number","func"],"mappings":"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","sourcesContent":["import _pt from \"prop-types\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useContext, useMemo, useEffect, useCallback } from 'react';\nimport { scaleBand } from '@visx/scale';\nimport isChildWithProps from '../../../typeguards/isChildWithProps';\nimport DataContext from '../../../context/DataContext';\nimport getScaleBandwidth from '../../../utils/getScaleBandwidth';\nimport getScaleBaseline from '../../../utils/getScaleBaseline';\nimport isValidNumber from '../../../typeguards/isValidNumber';\nimport { BARGROUP_EVENT_SOURCE, XYCHART_EVENT_SOURCE } from '../../../constants';\nimport useSeriesEvents from '../../../hooks/useSeriesEvents';\nimport findNearestGroupDatum from '../../../utils/findNearestGroupDatum';\nexport default function BaseBarGroup(_ref) {\n  var children = _ref.children,\n      _ref$padding = _ref.padding,\n      padding = _ref$padding === void 0 ? 0.1 : _ref$padding,\n      sortBars = _ref.sortBars,\n      BarsComponent = _ref.BarsComponent,\n      onBlur = _ref.onBlur,\n      onFocus = _ref.onFocus,\n      onPointerMove = _ref.onPointerMove,\n      onPointerOut = _ref.onPointerOut,\n      onPointerUp = _ref.onPointerUp,\n      _ref$enableEvents = _ref.enableEvents,\n      enableEvents = _ref$enableEvents === void 0 ? true : _ref$enableEvents;\n\n  var _ref2 = useContext(DataContext),\n      colorScale = _ref2.colorScale,\n      dataRegistry = _ref2.dataRegistry,\n      horizontal = _ref2.horizontal,\n      registerData = _ref2.registerData,\n      unregisterData = _ref2.unregisterData,\n      xScale = _ref2.xScale,\n      yScale = _ref2.yScale;\n\n  var barSeriesChildren = useMemo(function () {\n    return React.Children.toArray(children).filter(function (child) {\n      return isChildWithProps(child);\n    });\n  }, [children]); // extract data keys from child series\n\n  var dataKeys = useMemo(function () {\n    return barSeriesChildren.map(function (child) {\n      var _child$props$dataKey;\n\n      return (_child$props$dataKey = child.props.dataKey) != null ? _child$props$dataKey : '';\n    }).filter(function (key) {\n      return key;\n    });\n  }, [barSeriesChildren]); // register all child data\n\n  useEffect(function () {\n    var dataToRegister = barSeriesChildren.map(function (child) {\n      var _child$props = child.props,\n          key = _child$props.dataKey,\n          data = _child$props.data,\n          xAccessor = _child$props.xAccessor,\n          yAccessor = _child$props.yAccessor;\n      return {\n        key: key,\n        data: data,\n        xAccessor: xAccessor,\n        yAccessor: yAccessor\n      };\n    });\n    registerData(dataToRegister);\n    return function () {\n      return unregisterData(dataKeys);\n    };\n  }, [registerData, unregisterData, barSeriesChildren, dataKeys]); // create group scale\n\n  var groupScale = useMemo(function () {\n    return scaleBand({\n      domain: sortBars ? [].concat(dataKeys).sort(sortBars) : dataKeys,\n      range: [0, getScaleBandwidth(horizontal ? yScale : xScale)],\n      padding: padding\n    });\n  }, [sortBars, dataKeys, xScale, yScale, horizontal, padding]);\n  var findNearestDatum = useCallback(function (params) {\n    return findNearestGroupDatum(params, groupScale, horizontal);\n  }, [groupScale, horizontal]);\n  var ownEventSourceKey = BARGROUP_EVENT_SOURCE + \"-\" + dataKeys.join('-') + \"}\";\n  var eventEmitters = useSeriesEvents({\n    dataKey: dataKeys,\n    enableEvents: enableEvents,\n    findNearestDatum: findNearestDatum,\n    onBlur: onBlur,\n    onFocus: onFocus,\n    onPointerMove: onPointerMove,\n    onPointerOut: onPointerOut,\n    onPointerUp: onPointerUp,\n    source: ownEventSourceKey,\n    allowedSources: [XYCHART_EVENT_SOURCE, ownEventSourceKey]\n  });\n  var xZeroPosition = useMemo(function () {\n    return xScale ? getScaleBaseline(xScale) : 0;\n  }, [xScale]);\n  var yZeroPosition = useMemo(function () {\n    return yScale ? getScaleBaseline(yScale) : 0;\n  }, [yScale]);\n  var registryEntries = dataKeys.map(function (key) {\n    return dataRegistry.get(key);\n  }); // if scales and data are not available in the registry, bail\n\n  if (registryEntries.some(function (entry) {\n    return entry == null;\n  }) || !xScale || !yScale || !colorScale) {\n    return null;\n  }\n\n  var barThickness = getScaleBandwidth(groupScale);\n  var bars = registryEntries.flatMap(function (_ref3) {\n    var _groupScale, _barSeriesChildren$fi, _barSeriesChildren$fi2;\n\n    var xAccessor = _ref3.xAccessor,\n        yAccessor = _ref3.yAccessor,\n        data = _ref3.data,\n        key = _ref3.key;\n\n    var getLength = function getLength(d) {\n      var _xScale, _yScale;\n\n      return horizontal ? ((_xScale = xScale(xAccessor(d))) != null ? _xScale : NaN) - xZeroPosition : ((_yScale = yScale(yAccessor(d))) != null ? _yScale : NaN) - yZeroPosition;\n    };\n\n    var getGroupPosition = horizontal ? function (d) {\n      var _yScale2;\n\n      return (_yScale2 = yScale(yAccessor(d))) != null ? _yScale2 : NaN;\n    } : function (d) {\n      var _xScale2;\n\n      return (_xScale2 = xScale(xAccessor(d))) != null ? _xScale2 : NaN;\n    };\n    var withinGroupPosition = (_groupScale = groupScale(key)) != null ? _groupScale : 0;\n    var getX = horizontal ? function (d) {\n      return xZeroPosition + Math.min(0, getLength(d));\n    } : function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    };\n    var getY = horizontal ? function (d) {\n      return getGroupPosition(d) + withinGroupPosition;\n    } : function (d) {\n      return yZeroPosition + Math.min(0, getLength(d));\n    };\n    var getWidth = horizontal ? function (d) {\n      return Math.abs(getLength(d));\n    } : function () {\n      return barThickness;\n    };\n    var getHeight = horizontal ? function () {\n      return barThickness;\n    } : function (d) {\n      return Math.abs(getLength(d));\n    };\n    var colorAccessor = (_barSeriesChildren$fi = barSeriesChildren.find(function (child) {\n      return child.props.dataKey === key;\n    })) == null ? void 0 : (_barSeriesChildren$fi2 = _barSeriesChildren$fi.props) == null ? void 0 : _barSeriesChildren$fi2.colorAccessor;\n    return data.map(function (bar, index) {\n      var _colorAccessor;\n\n      var barX = getX(bar);\n      if (!isValidNumber(barX)) return null;\n      var barY = getY(bar);\n      if (!isValidNumber(barY)) return null;\n      var barWidth = getWidth(bar);\n      if (!isValidNumber(barWidth)) return null;\n      var barHeight = getHeight(bar);\n      if (!isValidNumber(barHeight)) return null;\n      return {\n        key: key + \"-\" + index,\n        x: barX,\n        y: barY,\n        width: barWidth,\n        height: barHeight,\n        fill: (_colorAccessor = colorAccessor == null ? void 0 : colorAccessor(bar, index)) != null ? _colorAccessor : colorScale(key)\n      };\n    }).filter(function (bar) {\n      return bar;\n    });\n  });\n  return /*#__PURE__*/React.createElement(\"g\", {\n    className: \"visx-bar-group\"\n  }, /*#__PURE__*/React.createElement(BarsComponent, _extends({\n    bars: bars,\n    horizontal: horizontal,\n    xScale: xScale,\n    yScale: yScale\n  }, eventEmitters)));\n}\nBaseBarGroup.propTypes = {\n  children: _pt.oneOfType([_pt.element, _pt.arrayOf(_pt.element)]).isRequired,\n  padding: _pt.number,\n  sortBars: _pt.func\n};"]},"metadata":{},"sourceType":"module"}